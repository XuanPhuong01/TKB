USE [TKB]
GO

/****** Object:  Table [dbo].[GV]    Script Date: 4/15/2025 4:34:29 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[GV](
	[MaGV] [varchar](10) NOT NULL,
	[TenGV] [nvarchar](20) NULL,
 CONSTRAINT [PK_GV] PRIMARY KEY CLUSTERED 
(
	[MaGV] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

USE [TKB]
GO

/****** Object:  Table [dbo].[Lop]    Script Date: 4/15/2025 4:34:55 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Lop](
	[MaLop] [varchar](10) NOT NULL,
	[TenLop] [nvarchar](20) NULL,
 CONSTRAINT [PK_Lop] PRIMARY KEY CLUSTERED 
(
	[MaLop] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
USE [TKB]
GO

/****** Object:  Table [dbo].[MonHoc]    Script Date: 4/15/2025 4:35:11 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[MonHoc](
	[MaMon] [varchar](10) NOT NULL,
	[Tenmon] [nvarchar](20) NULL,
	[Hocki] [nvarchar](20) NULL,
	[Sotiet] [int] NULL,
 CONSTRAINT [PK_MonHoc] PRIMARY KEY CLUSTERED 
(
	[MaMon] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
USE [TKB]
GO

/****** Object:  Table [dbo].[Phong]    Script Date: 4/15/2025 4:35:29 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Phong](
	[MaPhong] [varchar](10) NOT NULL,
	[TenPhong] [nvarchar](20) NULL,
 CONSTRAINT [PK_Phong] PRIMARY KEY CLUSTERED 
(
	[MaPhong] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
USE [TKB]
GO

/****** Object:  Table [dbo].[TT_KB]    Script Date: 4/15/2025 4:35:42 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TT_KB](
	[MaGV] [varchar](10) NULL,
	[MaLop] [varchar](10) NULL,
	[MaMon] [varchar](10) NULL,
	[MaPhong] [varchar](10) NULL,
	[Sotiet] [int] NULL,
	[Sotinchi] [int] NULL,
	[Ngay] [date] NULL,
	[Thu] [int] NULL,
	[Tietbatdau] [int] NULL,
	[Tietketthuc] [int] NULL
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[TT_KB]  WITH CHECK ADD  CONSTRAINT [FK_TT_KB_GV] FOREIGN KEY([MaGV])
REFERENCES [dbo].[GV] ([MaGV])
GO

ALTER TABLE [dbo].[TT_KB] CHECK CONSTRAINT [FK_TT_KB_GV]
GO

ALTER TABLE [dbo].[TT_KB]  WITH CHECK ADD  CONSTRAINT [FK_TT_KB_Lop] FOREIGN KEY([MaLop])
REFERENCES [dbo].[Lop] ([MaLop])
GO

ALTER TABLE [dbo].[TT_KB] CHECK CONSTRAINT [FK_TT_KB_Lop]
GO

ALTER TABLE [dbo].[TT_KB]  WITH CHECK ADD  CONSTRAINT [FK_TT_KB_MonHoc] FOREIGN KEY([MaMon])
REFERENCES [dbo].[MonHoc] ([MaMon])
GO

ALTER TABLE [dbo].[TT_KB] CHECK CONSTRAINT [FK_TT_KB_MonHoc]
GO

ALTER TABLE [dbo].[TT_KB]  WITH CHECK ADD  CONSTRAINT [FK_TT_KB_Phong] FOREIGN KEY([MaPhong])
REFERENCES [dbo].[Phong] ([MaPhong])
GO

ALTER TABLE [dbo].[TT_KB] CHECK CONSTRAINT [FK_TT_KB_Phong]
GO


SELECT
    GV.TenGV,
    MonHoc.Tenmon,
    TT_KB.TietBatDau,
    TT_KB.TietKetThuc
FROM TT_KB
JOIN GV ON TT_KB.MaGV = GV.MaGV
JOIN MonHoc ON TT_KB.MaMon = MonHoc.MaMon
WHERE TT_KB.TietBatDau <= 1 AND TT_KB.TietKetThuc >= 2;
